---
description: TypeScript and general coding standards for the project (2026 best practices)
globs: "**/*.{ts,tsx}"
alwaysApply: false
---

# Coding Standards (TypeScript, 2026)

## TypeScript
- Strict mode always (`"strict": true` in tsconfig)
- Use `satisfies` operator for type narrowing where appropriate
- Prefer `type` over `interface` unless extending is needed
- Use `as const` for literal types and enums
- Use `using` keyword for resource disposal (TC39 Explicit Resource Management)
- No `any` — use `unknown` and narrow with Zod or type guards
- Use TypeScript project references across monorepo packages

## Imports and modules
- ESM only (`"type": "module"` in package.json)
- Use path aliases: `@/` for src root in each app
- Barrel exports (`index.ts`) only for packages — avoid in app code (tree-shaking)

## Naming conventions
- Files: kebab-case (`create-bet-form.tsx`, `sequence-manager.ts`)
- Components: PascalCase (`CreateBetForm`)
- Functions/variables: camelCase (`createBet`, `betAmount`)
- Types/interfaces: PascalCase (`BetStatus`, `VaultBalance`)
- Constants: UPPER_SNAKE_CASE (`MAX_OPEN_BETS`, `REVEAL_TIMEOUT_SECS`)
- Zod schemas: PascalCase + Schema suffix (`CreateBetSchema`, `BetResponseSchema`)
- Database tables: snake_case (`vault_balances`, `tx_events`)

## Error handling
- Always use structured errors with error codes
- Backend: throw typed errors caught by global error handler middleware
- Never swallow errors with empty catch blocks
- Log errors with context (betId, walletAddress, txHash)

## Async patterns
- async/await everywhere (no raw Promises or callbacks)
- Use AbortController for cancellable operations
- Graceful shutdown: handle SIGTERM/SIGINT

## Testing
- Vitest for unit/integration tests
- Hono test client for API route tests
- MSW (Mock Service Worker) for frontend API mocking (generated by Orval)
- Test file colocation: `*.test.ts` next to source file

## Code quality
- ESLint with shared config from `packages/eslint-config`
- Prettier for formatting
- Husky + lint-staged for pre-commit hooks
- No console.log in production code — use pino logger

## Dependencies
- Pin exact versions in package.json
- Use pnpm for package management (strict deps, no phantom dependencies)
- Audit dependencies regularly (`pnpm audit`)

## Git conventions
- Conventional commits: `feat:`, `fix:`, `chore:`, `docs:`, `refactor:`, `test:`
- Branch naming: `feat/create-bet`, `fix/reveal-timeout`, `chore/update-deps`
