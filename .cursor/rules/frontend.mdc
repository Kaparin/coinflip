---
description: Frontend conventions — Next.js 15 UI for CoinFlip dApp
globs: apps/web/**/*.{ts,tsx}
alwaysApply: false
---

# Frontend (Next.js 15 / React 19 / TypeScript)

## Tech stack
- Next.js 15 with App Router and Turbopack
- React 19 with Server Components by default
- TypeScript strict mode
- Tailwind CSS 4 for styling
- TanStack Query v5 (React Query) for server state — hooks auto-generated by Orval
- Axiome Connect integration via `axiomesign://` QR/deeplink
- CosmJS for read-only RPC/gateway queries
- WebSocket connection to backend for real-time updates

## Project structure (apps/web/)
```
apps/web/
├── src/
│   ├── app/                  # App Router
│   │   ├── layout.tsx        # Root layout
│   │   ├── page.tsx          # Landing page
│   │   ├── (game)/           # Game route group
│   │   │   ├── page.tsx      # Main game screen
│   │   │   └── layout.tsx    # Game layout (connected wallet required)
│   │   └── (auth)/           # Auth route group
│   │       ├── connect/      # Wallet connect
│   │       └── onboard/      # 1-click onboarding
│   ├── components/
│   │   ├── ui/               # Reusable primitives (Button, Input, Modal, Toast, Card)
│   │   ├── layout/           # Header, Footer, Sidebar
│   │   └── features/
│   │       ├── bets/         # BetCard, BetList, CreateBetForm, AcceptBetModal
│   │       ├── vault/        # DepositModal, WithdrawModal, BalanceDisplay
│   │       ├── auth/         # ConnectWallet, OnboardingFlow, StatusChips
│   │       └── history/      # HistoryList, HistoryRow, LeaderboardTable
│   ├── hooks/
│   │   ├── use-wallet.ts     # Wallet connection state
│   │   ├── use-websocket.ts  # WebSocket real-time updates
│   │   └── use-commitment.ts # Client-side commit-reveal crypto
│   ├── lib/
│   │   ├── axiome-connect.ts # Axiome Connect payload generation
│   │   ├── crypto.ts         # SHA256 commitment, secret generation
│   │   ├── format.ts         # Address truncation, amount formatting
│   │   └── constants.ts      # Contract addresses, chain config
│   ├── types/                # Domain types (supplementary to generated)
│   └── config/               # Environment config
├── package.json
├── next.config.ts
└── tsconfig.json
```

## API consumption
- Use Orval-generated React Query hooks from `packages/api-client`
- NEVER write fetch calls manually — always use generated hooks
- Example: `const { data } = useGetBets({ status: 'open' })`
- Mutations: `const { mutate } = useCreateBet()`

## Key screens

### Landing
- "Enter" / "Connect Wallet" button
- "How it works" modal
- Clean, minimal design

### Main game screen
- Top bar: avatar, short address, balances (wallet LAUNCH, vault available, vault locked)
- Status chips: 1-click enabled, sponsored gas enabled
- Action block: preset amounts (10/25/50/100/250/500/1000), Create bet, Auto-reveal toggle
- Open bets list: virtualized (TanStack Virtual), lazy loading
- History list with tx hash → explorer links
- Real-time toasts via WebSocket

## Client-side crypto (commit-reveal)
- Generate 32 random bytes: `crypto.getRandomValues(new Uint8Array(32))`
- Commitment: `SHA256("coinflip_v1" || maker_addr || side || secret)`
- Store secret in memory (React state) — NEVER in localStorage for security
- NEVER send secret to backend before reveal

## UX principles
- Desktop-first, mobile responsive
- Minimal interactions, fast feedback
- Show tx hashes with explorer links
- Optimistic UI updates via React Query mutations + WebSocket confirmations
- Loading skeletons, not spinners
- Error boundaries for graceful failure
